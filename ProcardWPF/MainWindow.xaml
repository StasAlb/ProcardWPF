<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:self="clr-namespace:ProcardWPF"
        xmlns:common="clr-namespace:Common;assembly=Common"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:neoBar="clr-namespace:Neodynamic.WPF;assembly=Neodynamic.WPF.Barcode" 
        x:Class="ProcardWPF.fMain"
        xmlns:toolk="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="{DynamicResource WindowTitle}" Height="850" Loaded="Window_Loaded" Width="900"
        Icon="Procard.ico"
        >
    <Window.Resources>
        <VisualBrush x:Key="HatchBrush" TileMode="Tile" Viewport="0,0,6,6" ViewportUnits="Absolute" Viewbox="0,0,6,6" ViewboxUnits="Absolute">
            <VisualBrush.RelativeTransform>
                <RotateTransform Angle="45" CenterX="0" CenterY="0"></RotateTransform>
            </VisualBrush.RelativeTransform>
            <VisualBrush.Visual>
                <Canvas>
                    <Path Stroke="Black" Data="M6 0l0 6"/>
                </Canvas>
            </VisualBrush.Visual>
        </VisualBrush>
        <Style x:Key="myStyle">
            <Style.Resources>
                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Red"/>
                <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Red"/>
                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Red"/>
            </Style.Resources> 
        </Style>
        <Style x:Key="labelStyle">
            <Setter Property="Control.FontWeight" Value="Bold"></Setter>
        </Style>
        <Style x:Key="textBoxStyle">
            <Setter Property="Control.Height" Value="20"></Setter>
            <Setter Property="Control.VerticalAlignment" Value="Center"></Setter>
            <Setter Property="Control.HorizontalAlignment" Value="Left"></Setter>
        </Style>
        <common:DoubleConverter x:Key="DoubleConverter"></common:DoubleConverter>
        <ObjectDataProvider x:Key="FontEnum" MethodName="GetValues" ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="self:EmbossFont"></x:Type>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="BarcodeEnum" MethodName="GetValues" ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="neoBar:Symbology"></x:Type>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="{x:Static self:CustomCommands.FileNew}" Executed="Command_FileNew" CanExecute="Command_FileNewCanBeExecuted" />
        <CommandBinding Command="{x:Static self:CustomCommands.FileOpen}" Executed="Command_FileOpen" CanExecute="Command_FileOpenCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FileSave}" Executed="Command_FileSave" CanExecute="Command_FileSaveCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FileSaveAs}" Executed="Command_FileSaveAs" CanExecute="Command_FileSaveAsCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.LanguageRussian}" Executed="Command_Russian" CanExecute="Command_RussianCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.LanguageEnglish}" Executed="Command_English" CanExecute="Command_EnglishCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.Pointer}" Executed="Command_Pointer" CanExecute="Command_PointerCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.EmbossLine}" Executed="Command_EmbossLine" CanExecute="Command_EmbossLineCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.EmbossField}" Executed="Command_EmbossField" CanExecute="Command_EmbossFieldCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.EmbossField2}" Executed="Command_EmbossField2" CanExecute="Command_EmbossField2CanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.MagStripe}" Executed="Command_MagStripe" CanExecute="Command_MagStripeCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.TextField}" Executed="Command_TextField" CanExecute="Command_TextFieldCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.ImageField}" Executed="Command_ImageField" CanExecute="Command_ImageFieldCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.BarCode}" Executed="Command_Barcode" CanExecute="Command_BarcodeCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.Topcoat}" Executed="Command_Topcoat" CanExecute="Command_TopcoatCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.SmartField}" Executed="Command_SmartField" CanExecute="Command_SmartFieldCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.ReportField}" Executed="Command_ReportField" CanExecute="Command_ReportFieldCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FieldUp}" Executed="Command_FieldUp" CanExecute="Command_FieldUpCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FieldDown}" Executed="Command_FieldDown" CanExecute="Command_FieldDownCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FieldFirst}" Executed="Command_FieldFirst" CanExecute="Command_FieldFirstCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FieldEnd}" Executed="Command_FieldEnd" CanExecute="Command_FieldEndCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.SendToPrint}" Executed="Command_SendToPrint" CanExecute="Command_SendToPrintCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.LastRecord}" Executed="Command_LastRecord" CanExecute="Command_LastRecordCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.PrevRecord}" Executed="Command_PrevRecord" CanExecute="Command_PrevRecordCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.NextRecord}" Executed="Command_NextRecord" CanExecute="Command_NextRecordCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.FirstRecord}" Executed="Command_FirstRecord" CanExecute="Command_FirstRecordCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.LoadDbFile}" Executed="Command_LoadDbFile" CanExecute="Command_LoadDbFileCanBeExecuted" />
        <CommandBinding Command="{x:Static self:CustomCommands.DesignMode}" Executed="Command_DesignMode" CanExecute="Command_DesignModeCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.PrintMode}" Executed="Command_PrintMode" CanExecute="Command_PrintModeCanBeExecuted"/>
        <CommandBinding Command="{x:Static self:CustomCommands.SmartDefaultSave}" Executed="Command_SmartDefaultSave" CanExecute="Command_SmartDefaultSaveCanBeExecuted"></CommandBinding>
        <CommandBinding Command="{x:Static self:CustomCommands.SmartDefaultLoad}" Executed="Command_SmartDefaultLoad" CanExecute="Command_SmartDefaultLoadCanBeExecuted"></CommandBinding>
    </Window.CommandBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="28"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="23"/>
        </Grid.RowDefinitions>
        <StackPanel x:Name="spMainMenu" Grid.Row="0" Orientation="Horizontal" Background="#FFF0F0F0">
            <ToolBarTray>
                <ToolBar x:Name="Main" Background="#FFF0F0F0">
                    <Menu Background="#FFF0F0F0" FontWeight="Bold">
                        <MenuItem Header="{DynamicResource Menu_Menu}" InputGestureText="Ctrl+M">
                            <MenuItem Header="{DynamicResource Menu_New}" InputGestureText="Ctrl+N" Command="{x:Static self:CustomCommands.FileNew}"/>
                            <Separator/>
                            <MenuItem Header="{DynamicResource Menu_Open}" InputGestureText="Ctrl+O" Command="{x:Static self:CustomCommands.FileOpen}"/>
                            <MenuItem Header="{DynamicResource Menu_Save}" InputGestureText="Ctrl+S" Command="{x:Static self:CustomCommands.FileSave}"/>
                            <MenuItem Header="{DynamicResource Menu_SaveAs}"  Command="{x:Static self:CustomCommands.FileSaveAs}"/>
                            <MenuItem Header="{DynamicResource Menu_Close}" InputGestureText="Ctrl+X"/>
                            <Separator/>
                            <MenuItem Header="{DynamicResource Menu_Regim}">
                                <MenuItem Header="{DynamicResource Menu_Design}" Command="{x:Static self:CustomCommands.DesignMode}"/>
                                <MenuItem Header="{DynamicResource Menu_Print}" Command="{x:Static self:CustomCommands.PrintMode}"/>
                            </MenuItem>
                            <MenuItem Header="{DynamicResource Menu_Security}">
                                <MenuItem Header="{DynamicResource Menu_BeginSession}"/>
                                <MenuItem Header="{DynamicResource Menu_EndSession}"/>
                                <MenuItem Header="{DynamicResource Menu_SecurityProperties}"/>
                            </MenuItem>
                            <MenuItem Header="{DynamicResource Menu_Language}">
                                <MenuItem Header="{DynamicResource Menu_LangRussian}" Command="{x:Static self:CustomCommands.LanguageRussian}"/>
                                <MenuItem Header="{DynamicResource Menu_LangEnglish}" Command="{x:Static self:CustomCommands.LanguageEnglish}"/>
                            </MenuItem>
                            <MenuItem Header="{DynamicResource Menu_Properties}"/>
                            <Separator/>
                            <MenuItem Header="{DynamicResource Menu_LastFiles}"/>
                            <Separator/>
                            <MenuItem Header="{DynamicResource Menu_Exit}" InputGestureText="Alt+F4"/>
                        </MenuItem>
                    </Menu>
                    <Separator/>
                    <Button ToolTip="{DynamicResource ToolBar_New}" Command="{x:Static self:CustomCommands.FileNew}">
                        <Canvas Width="24" Height="24">                            
                            <Path Data="M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z" Fill="Black" />
                        </Canvas>
                        <!--<Image Source="pack://application:,,,/Images/New.bmp"/>-->
                    </Button>
                    <Button ToolTip="{DynamicResource ToolBar_Open}" Command="{x:Static self:CustomCommands.FileOpen}">
                        <Canvas Width="24" Height="24">
                            <Path Data="M9,18V15H5V11H9V8L14,13M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z" Fill="Black" />
                        </Canvas>
                        <!--<Image Source="pack://application:,,,/Images/Open.bmp"/>-->
                    </Button>
                    <Button ToolTip="{DynamicResource ToolBar_Save}" Command="{x:Static self:CustomCommands.FileSave}">
                        <Canvas Width="24" Height="24">
                            <Path Data="M20,6A2,2 0 0,1 22,8V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H20M19.25,13H16V9H14V13H10.75L15,17.25" Fill="Black" />
                        </Canvas>
                        <!--<Image Source="pack://application:,,,/Images/Save.bmp"/>-->
                    </Button>
                    <Separator/>
                    <Button ToolTip="{DynamicResource ToolBar_Design}" Command="{x:Static self:CustomCommands.DesignMode}">
                        <Canvas Width="24" Height="24">
                            <Path Data="M18,4V3A1,1 0 0,0 17,2H5A1,1 0 0,0 4,3V7A1,1 0 0,0 5,8H17A1,1 0 0,0 18,7V6H19V10H9V21A1,1 0 0,0 10,22H12A1,1 0 0,0 13,21V12H21V4H18Z" Fill="Black" />
                        </Canvas>
                        <!--<Image Source="pack://application:,,,/Images/Paint.bmp"/>-->
                    </Button>
                    <Button ToolTip="{DynamicResource ToolBar_Print}" Command="{x:Static self:CustomCommands.PrintMode}">
                        <Button.LayoutTransform>
                            <ScaleTransform ScaleX="-1"></ScaleTransform>
                        </Button.LayoutTransform>
                        <Canvas Width="24" Height="24">
                            <Path Data="M4,2C2.89,2 2,2.89 2,4V14H4V4H14V2H4M8,6C6.89,6 6,6.89 6,8V18H8V8H18V6H8M12,10C10.89,10 10,10.89 10,12V20C10,21.11 10.89,22 12,22H20C21.11,22 22,21.11 22,20V12C22,10.89 21.11,10 20,10H12Z" Fill="Black" />
                        </Canvas>
                        <!--<Image Source="pack://application:,,,/Images/Print.bmp"/>-->
                    </Button>
                </ToolBar>
            </ToolBarTray>
        </StackPanel>
        <Grid x:Name="gLogo" Grid.Row="1" Visibility="Hidden" Background="#FFF0F0F0" >
            <Viewbox Stretch="None" Height="100" Width="500"> 
                <Canvas>
                    <!--<Path Data="M-180,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M-125,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M-70,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M-15,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M35,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M90,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>
                    <Path Data="M145,40v-80h40v80z" Stroke="Gray" StrokeThickness="1"></Path>-->
                    
                    <Path Data="M-180,40v-80h20a20,20 0 0,1 0 40h-20" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M-125,40v-80h20a20,20 0 0,1 0 40h-17l37,40" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M-50,40a20,40 0 0,1 0,-80a20,40 0 0,1 0,80" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M25,20a20,40 0 1,1 0,-40" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M35,40l20,-75l20,75m-10,-30h-20" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M90,40v-80h20a20,20 0 0,1 0 40h-17l37,40" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M145,40v-80a20,20 0 0,1 0,80" Stroke="Black" StrokeThickness="5"></Path>
                    <Path Data="M200,-40a10,10 0 0,1 20,0c-1,8 -10,10 -20,20v5h21m5,0h3m5,-17a10,17 0,1,1, 0,1" Stroke="Red" StrokeThickness="3"></Path>
                    <Path Data="M9.23,17.59V23.12H6.88V6.72C6.88,5.27 7.31,4.13 8.16,3.28C9,2.43 10.17,2 11.61,2C13,2 14.07,2.34 14.87,3C15.66,3.68 16.05,4.62 16.05,5.81C16.05,6.63 15.79,7.4 15.27,8.11C14.75,8.82 14.08,9.31 13.25,9.58V9.62C14.5,9.82 15.47,10.27 16.13,11C16.79,11.71 17.12,12.62 17.12,13.74C17.12,15.06 16.66,16.14 15.75,16.97C14.83,17.8 13.63,18.21 12.13,18.21C11.07,18.21 10.1,18 9.23,17.59M10.72,10.75V8.83C11.59,8.72 12.3,8.4 12.87,7.86C13.43,7.31 13.71,6.7 13.71,6C13.71,4.62 13,3.92 11.6,3.92C10.84,3.92 10.25,4.16 9.84,4.65C9.43,5.14 9.23,5.82 9.23,6.71V15.5C10.14,16.03 11.03,16.29 11.89,16.29C12.73,16.29 13.39,16.07 13.86,15.64C14.33,15.2 14.56,14.58 14.56,13.79C14.56,12 13.28,11 10.72,10.75Z" Fill="Red">
                        <Path.RenderTransform>
                            <TranslateTransform X="255" Y="-30"></TranslateTransform>
                        </Path.RenderTransform>
                    </Path>
                </Canvas>
                <!--<Image Source="pack://application:,,,/Images/Procard.jpg"/>-->
            </Viewbox>
        </Grid>
        <Grid x:Name="gDesign" Grid.Row="1" Visibility="Visible">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="28"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel x:Name="spDesignToolbar" Grid.Row="0" Orientation="Horizontal" Background="#FFF0F0F0">
                    <ToolBarTray  Background="#FFF0F0F0">
                        <ToolBar x:Name="tbDesign">
                            <Button x:Name="bPointer" ToolTip="{DynamicResource ToolBar_Pointer}" Command="{x:Static self:CustomCommands.Pointer}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Width="24" Source="pack://application:,,,/Images/Pointer.bmp "/>-->
                                <!--<Image Width="24" Source="pack://application:,,,/Images/24х24.jpg "/>-->
                            </Button>
                            <Separator/>
                            <Button x:Name="bEmbossLine" ToolTip="{DynamicResource ToolBar_EmbossLine}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.EmbossLine}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M7,13H21V11H7M7,19H21V17H7M7,7H21V5H7M2,11H3.8L2,13.1V14H5V13H3.2L5,10.9V10H2M3,8H4V4H2V5H3M2,17H4V17.5H3V18.5H4V19H2V20H5V16H2V17Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/EmbossLine.bmp"/>-->
                            </Button>
                            <ToggleButton x:Name="bEmbossField" ToolTip="{DynamicResource ToolBar_EmbossField}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.EmbossField}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M8,19H11V23H13V19H16L12,15L8,19M16,5H13V1H11V5H8L12,9L16,5M4,11V13H20V11H4Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/EmbossText.bmp"/>-->
                            </ToggleButton>
                            <Button ToolTip="{DynamicResource ToolBar_EmbossField2}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.EmbossField2}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M8,19H11V23H13V19H16L12,15L8,19M16,5H13V1H11V5H8L12,9L16,5M4,11V13H20V11H4M21.85,9H16.97V8L17.86,7.18C18.62,6.54 19.18,6 19.56,5.55C19.93,5.11 20.12,4.7 20.13,4.32C20.14,4.04 20.05,3.8 19.86,3.62C19.68,3.43 19.39,3.34 19,3.33C18.69,3.34 18.42,3.4 18.16,3.5L17.5,3.89L17.05,2.72C17.32,2.5 17.64,2.33 18.03,2.19C18.42,2.05 18.85,2 19.32,2C20.1,2 20.7,2.2 21.1,2.61C21.5,3 21.72,3.54 21.72,4.18C21.71,4.74 21.53,5.26 21.18,5.73C20.84,6.21 20.42,6.66 19.91,7.09L19.27,7.61V7.63H21.85V9Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/EmbossText2.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_MagStripe}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.MagStripe}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/MagStripe.bmp"/>-->
                            </Button>
                            <ToggleButton x:Name="bTextField" ToolTip="{DynamicResource ToolBar_TextField}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.TextField}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <!--<Path Data="M5,4v3h5.5v12h3V7H19V4z" Fill="Black"></Path>-->
                                    <Path Data="M6,11A2,2 0 0,1 8,13V17H4A2,2 0 0,1 2,15V13A2,2 0 0,1 4,11H6M4,13V15H6V13H4M20,13V15H22V17H20A2,2 0 0,1 18,15V13A2,2 0 0,1 20,11H22V13H20M12,7V11H14A2,2 0 0,1 16,13V15A2,2 0 0,1 14,17H12A2,2 0 0,1 10,15V7H12M12,15H14V13H12V15Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Text.bmp"/>-->
                            </ToggleButton>
                            <ToggleButton x:Name="bImageField" ToolTip="{DynamicResource ToolBar_ImageField}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.ImageField}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M1,5h2v14L1,19zM5,5h2v14L5,19zM22,5L10,5c-0.55,0 -1,0.45 -1,1v12c0,0.55 0.45,1 1,1h12c0.55,0 1,-0.45 1,-1L23,6c0,-0.55 -0.45,-1 -1,-1zM11,17l2.5,-3.15L15.29,16l2.5,-3.22L21,17L11,17z" Fill="Black"></Path>
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Image.bmp"/>-->
                            </ToggleButton>
                            <ToggleButton x:Name="bBarcodeField"  ToolTip="{DynamicResource ToolBar_BarCode}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.BarCode}" IsEnabled="True">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M4,6H6V18H4V6M7,6H8V18H7V6M9,6H12V18H9V6M13,6H14V18H13V6M16,6H18V18H16V6M19,6H20V18H19V6M2,4V8H0V4A2,2 0 0,1 2,2H6V4H2M22,2A2,2 0 0,1 24,4V8H22V4H18V2H22M2,16V20H6V22H2A2,2 0 0,1 0,20V16H2M22,20V16H24V20A2,2 0 0,1 22,22H18V20H22Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Barcode.bmp"/>-->
                            </ToggleButton>
                            <ToggleButton x:Name="bTopcoatField" ToolTip="{DynamicResource ToolBar_Topcoat}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.Topcoat}" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M23,15h-2v2h2v-2zM23,11h-2v2h2v-2zM23,19h-2v2c1,0 2,-1 2,-2zM15,3h-2v2h2L15,3zM23,7h-2v2h2L23,7zM21,3v2h2c0,-1 -1,-2 -2,-2zM3,21h8v-6L1,15v4c0,1.1 0.9,2 2,2zM3,7L1,7v2h2L3,7zM15,19h-2v2h2v-2zM19,3h-2v2h2L19,3zM19,19h-2v2h2v-2zM3,3C2,3 1,4 1,5h2L3,3zM3,11L1,11v2h2v-2zM11,3L9,3v2h2L11,3zM7,3L5,3v2h2L7,3z" Fill="Black"></Path>
                                </Canvas>

                                <!--<Image Source="pack://application:,,,/Images/Topcoat.bmp"/>-->
                            </ToggleButton>
                            <Button ToolTip="{DynamicResource ToolBar_SmartField}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.SmartField}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M15,9L9,9v6h6L15,9zM13,13h-2v-2h2v2zM21,11L21,9h-2L19,7c0,-1.1 -0.9,-2 -2,-2h-2L15,3h-2v2h-2L11,3L9,3v2L7,5c-1.1,0 -2,0.9 -2,2v2L3,9v2h2v2L3,13v2h2v2c0,1.1 0.9,2 2,2h2v2h2v-2h2v2h2v-2h2c1.1,0 2,-0.9 2,-2v-2h2v-2h-2v-2h2zM17,17L7,17L7,7h10v10z" Fill="Black"></Path>
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Smart.bmp"/>-->
                            </Button>
                            <ToggleButton ToolTip="{DynamicResource ToolBar_ReportField}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.ReportField}" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M13,2A2,2 0 0,0 11,4V20A2,2 0 0,0 13,22H22V2H13M20,10V14H13V10H20M20,16V20H13V16H20M20,4V8H13V4H20M9,11H6V8H4V11H1V13H4V16H6V13H9V11Z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/ReportField.bmp"/>-->
                            </ToggleButton>
                            <Separator/>
                            <Button ToolTip="{DynamicResource ToolBar_Up}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.FieldUp}">
                                <Button.LayoutTransform>
                                    <RotateTransform Angle="180"></RotateTransform>
                                </Button.LayoutTransform>
                                <Canvas Width="24" Height="24">
                                    <Path Data="M19,12h-4v-6h-6v6h-4l7,7 7,-7z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Up.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_Down}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.FieldDown}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M19,12h-4v-6h-6v6h-4l7,7 7,-7z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Down.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_First}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.FieldFirst}">
                                <Button.LayoutTransform>
                                    <RotateTransform Angle="180"></RotateTransform>
                                </Button.LayoutTransform>
                                <Canvas Width="24" Height="24">
                                    <Path Data="M19,12h-4v-6h-6v6h-4l7,7 7,-7zM19,19v2h-14v-2z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Home.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_End}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.FieldEnd}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M19,12h-4v-6h-6v6h-4l7,7 7,-7zM19,19v2h-14v-2z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/End.bmp"/>-->
                            </Button>
                            <Separator/>
                            <Button ToolTip="{DynamicResource ToolBar_MasMinus}" ToolTipService.ShowOnDisabled="True" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M15.5,14h-0.79l-0.28,-0.27C15.41,12.59 16,11.11 16,9.5 16,5.91 13.09,3 9.5,3S3,5.91 3,9.5 5.91,16 9.5,16c1.61,0 3.09,-0.59 4.23,-1.57l0.27,0.28v0.79l5,4.99L20.49,19l-4.99,-5zM9.5,14C7.01,14 5,11.99 5,9.5S7.01,5 9.5,5 14,7.01 14,9.5 11.99,14 9.5,14zM7,9h5v1L7,10z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/MasMinus.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_MasDefault}" ToolTipService.ShowOnDisabled="True" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M15.5,14h-0.79l-0.28,-0.27C15.41,12.59 16,11.11 16,9.5 16,5.91 13.09,3 9.5,3S3,5.91 3,9.5 5.91,16 9.5,16c1.61,0 3.09,-0.59 4.23,-1.57l0.27,0.28v0.79l5,4.99L20.49,19l-4.99,-5zM9.5,14C7.01,14 5,11.99 5,9.5S7.01,5 9.5,5 14,7.01 14,9.5 11.99,14 9.5,14z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/MasDefault.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_MasPlus}" ToolTipService.ShowOnDisabled="True" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M15.5,14h-0.79l-0.28,-0.27C15.41,12.59 16,11.11 16,9.5 16,5.91 13.09,3 9.5,3S3,5.91 3,9.5 5.91,16 9.5,16c1.61,0 3.09,-0.59 4.23,-1.57l0.27,0.28v0.79l5,4.99L20.49,19l-4.99,-5zM9.5,14C7.01,14 5,11.99 5,9.5S7.01,5 9.5,5 14,7.01 14,9.5 11.99,14 9.5,14zM12,10h-2v2L9,12v-2L7,10L7,9h2L9,7h1v2h2v1z" Fill="Black" />
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/MasPlus.bmp"/>-->
                            </Button>
                            <Button ToolTip="{DynamicResource ToolBar_Setka}" ToolTipService.ShowOnDisabled="True" IsEnabled="False">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M7,5h2L9,3L7,3v2zM7,13h2v-2L7,11v2zM7,21h2v-2L7,19v2zM11,17h2v-2h-2v2zM11,21h2v-2h-2v2zM3,21h2v-2L3,19v2zM3,17h2v-2L3,15v2zM3,13h2v-2L3,11v2zM3,9h2L5,7L3,7v2zM3,5h2L5,3L3,3v2zM11,13h2v-2h-2v2zM19,17h2v-2h-2v2zM19,13h2v-2h-2v2zM19,21h2v-2h-2v2zM19,9h2L21,7h-2v2zM11,9h2L13,7h-2v2zM19,3v2h2L21,3h-2zM11,5h2L13,3h-2v2zM15,21h2v-2h-2v2zM15,13h2v-2h-2v2zM15,5h2L17,3h-2v2z" Fill="Black"></Path>
                                </Canvas>
                                <!--<Image Source="pack://application:,,,/Images/Setka.bmp"/>-->
                            </Button>
                        </ToolBar>
                    </ToolBarTray>
                </StackPanel>
                <Grid x:Name="gDesigns" Grid.Row="1" RenderTransformOrigin="0.458,0.534">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.4*" MinWidth="100"/>
                        <ColumnDefinition Width="*" MinWidth="100"/>
                    </Grid.ColumnDefinitions>
                    <Grid x:Name="gDesignPanels" Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="1.6*" MinHeight="100"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*" MinHeight="10"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <self:DrawPanel x:Name="dpDesignFront" Background="White" ClipToBounds="True" MouseMove="dpDesignFront_MouseMove" 
								MouseDown="dpDesignFront_MouseDown" MouseUp="dpDesignFront_MouseUp" SizeChanged="dpDesignFront_SizeChanged">
                            </self:DrawPanel>
                        </Grid>
                        <GridSplitter Grid.Row="1" HorizontalAlignment="Stretch" Cursor="SizeNS" Height="5"/>
                        <Grid Grid.Row="2">
                            <self:DrawPanel x:Name="dpDesignBack" Background="White" ClipToBounds="True" MouseMove="dpDesignBack_MouseMove" 
								MouseDown="dpDesignBack_MouseDown" MouseUp="dpDesignBack_MouseUp"/>
                        </Grid>
                    </Grid>
                    <GridSplitter Grid.Column="0" VerticalAlignment="Stretch" Cursor="SizeWE" Width="5"/>
                    <StackPanel x:Name="spDesignProperties" Grid.Column="1" Background="#FFF0F0F0">
                        <GroupBox Height="260" Header="{DynamicResource Fields_List}" FontWeight="Bold">
                            <ListBox x:Name="lbFields" SelectionChanged="lbFields_SelectionChanged" Style="{StaticResource myStyle}" KeyUp="lbFields_KeyUp">
                            </ListBox>
<!--
                            <ListBox x:Name="lbFields" Style="{StaticResource myStyle}" HorizontalContentAlignment="Stretch" SelectionChanged="lbFields_SelectionChanged">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"></TextBlock>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox> -->
                        </GroupBox>
                        <GroupBox x:Name="gbFieldCommon" VerticalAlignment="Center">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="104"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="26"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label Grid.Column="0" Style="{StaticResource labelStyle}" Content="{DynamicResource Card_Name}" Width="104"/>
                                <TextBox x:Name="tbFieldName" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Style="{StaticResource textBoxStyle}">
                                    <TextBox.Text>
                                        <Binding Path="Name" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                            <Binding.ValidationRules>
                                                <common:StringRule></common:StringRule>
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <Grid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" x:Name="gFieldCommon">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="26"/>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Column="0"  Style="{StaticResource labelStyle}" Content="X:"/>
                                        <TextBox x:Name="tbFieldX" Width="40" Grid.Column="1" Style="{StaticResource textBoxStyle}">
                                            <TextBox.Text>
                                                <Binding Path="X" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                    <Binding.ValidationRules>
                                                        <common:DoubleRule></common:DoubleRule>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                        <Label Grid.Column="2"  Style="{StaticResource labelStyle}" Content="Y:"/>
                                        <TextBox x:Name="tbFieldY" Width="40" Grid.Column="3" Style="{StaticResource textBoxStyle}">
                                            <TextBox.Text>
                                                <Binding Path="Y" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                    <Binding.ValidationRules>
                                                        <common:DoubleRule></common:DoubleRule>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                        <Label Grid.Column="4"  Style="{StaticResource labelStyle}" Content="{DynamicResource Field_Width}"/>
                                        <TextBox x:Name="tbFieldWidth" Width="40" Grid.Column="5" Style="{StaticResource textBoxStyle}">
                                            <TextBox.Text>
                                                <Binding Path="Width" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                    <Binding.ValidationRules>
                                                        <common:DoubleRule></common:DoubleRule>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                        <Label Grid.Column="6"  Style="{StaticResource labelStyle}" Content="{DynamicResource Field_Height}"/>
                                        <TextBox x:Name="tbFieldHeight" Width="40" Grid.Column="7" Style="{StaticResource textBoxStyle}">
                                            <TextBox.Text>
                                                <Binding Path="Height" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                    <Binding.ValidationRules>
                                                        <common:DoubleRule></common:DoubleRule>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                        <Grid>
                            <GroupBox Grid.Row="0" x:Name="gbCard" Visibility="Hidden" Height="500" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="28"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="26"/>
                                        <RowDefinition Height="26"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Style="{StaticResource labelStyle}" Content="{DynamicResource Card_InDb}"/>
                                    <TextBox x:Name="tbDbIn" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="22" IsReadOnly="True"/>
                                    <Button x:Name="bDBIn" Grid.Row="0" Grid.Column="2" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bDBIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" >
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />                                        
                                    </Button>
                                    <Label Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Style="{StaticResource labelStyle}" Content="{DynamicResource Card_OutDb}"/>
                                    <TextBox x:Name="tbDbOut" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center" Height="22" IsReadOnly="True"/>
                                    <Button x:Name="bDBOut" Grid.Row="1" Grid.Column="2" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bDBOut_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                    </Button>
                                    <DockPanel Grid.Row="2" Grid.Column="0" LastChildFill="False">
                                        <Label Content="{DynamicResource Card_Device}" DockPanel.Dock="Top" Style="{StaticResource labelStyle}"/>
                                    </DockPanel>
                                    <DockPanel Grid.Row="2" Grid.Column="1" LastChildFill="False">
                                        <ComboBox x:Name="cbDevice" DockPanel.Dock="Top" Height="22" SelectionChanged="cbDevice_SelectionChanged"></ComboBox>
                                    </DockPanel>
                                    <DockPanel Grid.Row="2" Grid.Column="2" LastChildFill="False">
                                        <Button x:Name="bDeviceProperies" DockPanel.Dock="Top" Height="24" Width="25" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bDeviceProperies_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                            <Path Data="M21,3.01H3c-1.1,0 -2,0.9 -2,2V9h2V4.99h18v14.03H3V15H1v4.01c0,1.1 0.9,1.98 2,1.98h18c1.1,0 2,-0.88 2,-1.98v-14c0,-1.11 -0.9,-2 -2,-2zM11,16l4,-4 -4,-4v3H1v2h10v3z" Fill="Black"></Path>
                                        </Button>
                                    </DockPanel>
                                    <Border BorderBrush="Gray" CornerRadius="0,10,10,10" BorderThickness="0" Name="borderDevice" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Height="260" VerticalAlignment="Top" Visibility="Hidden">
                                        <GroupBox x:Name="gbDeviceEmboss" Margin="10,25,0,0">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="115"></ColumnDefinition>
                                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="36"></RowDefinition>
                                                    <RowDefinition Height="36"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                </Grid.RowDefinitions>
                                                <Label Content="{DynamicResource Emboss_ComPort}" Grid.Row="0" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cbComPort" Grid.Row="0" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cbComPort_SelectionChanged" Width="150" HorizontalAlignment="Left"></ComboBox>
                                                <Label Content="{DynamicResource Emboss_Baudrate}" Grid.Row="1" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cbComBaudrate" Grid.Row="1" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cbComBaudrate_SelectionChanged" Width="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem>1200</ComboBoxItem>
                                                    <ComboBoxItem>2400</ComboBoxItem>
                                                    <ComboBoxItem>4800</ComboBoxItem>
                                                    <ComboBoxItem>9600</ComboBoxItem>
                                                    <ComboBoxItem>14400</ComboBoxItem>
                                                    <ComboBoxItem>19200</ComboBoxItem>
                                                    <ComboBoxItem>38400</ComboBoxItem>
                                                </ComboBox>
                                                <Label Content="{DynamicResource Emboss_Bits}" Grid.Row="2" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cbComBit" Grid.Row="2" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cbComBit_SelectionChanged" Width="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem>5</ComboBoxItem>
                                                    <ComboBoxItem>6</ComboBoxItem>
                                                    <ComboBoxItem>7</ComboBoxItem>
                                                    <ComboBoxItem>8</ComboBoxItem>
                                                </ComboBox>
                                                <Label Content="{DynamicResource Emboss_Control}" Grid.Row="3" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cbComParity" Grid.Row="3" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cbComParity_SelectionChanged" Width="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem>Even</ComboBoxItem>
                                                    <ComboBoxItem>Odd</ComboBoxItem>
                                                    <ComboBoxItem>None</ComboBoxItem>
                                                    <ComboBoxItem>Mark</ComboBoxItem>
                                                    <ComboBoxItem>Space</ComboBoxItem>
                                                </ComboBox>
                                                <Label Content="{DynamicResource Emboss_StopBit}" Grid.Row="4" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cbComStopbits" Grid.Row="4" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cbComStopbits_SelectionChanged" Width="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem>1</ComboBoxItem>
                                                    <ComboBoxItem>1.5</ComboBoxItem>
                                                    <ComboBoxItem>2</ComboBoxItem>
                                                </ComboBox>
                                                <TextBlock Text="{DynamicResource 450_Indent}" Grid.Row="5" Grid.Column="0" Style="{StaticResource labelStyle}" TextWrapping="Wrap"></TextBlock>
                                                <ComboBox x:Name="cb450Indent" Grid.Row="5" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cb450Indent_SelectionChanged" Width="150" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                    <ComboBoxItem Content="{DynamicResource 450_IndentStandard}"></ComboBoxItem>
                                                    <ComboBoxItem Content="{DynamicResource 450_IndentFront}"></ComboBoxItem>
                                                    <ComboBoxItem Content="{DynamicResource 450_IndentBack}"></ComboBoxItem>
                                                </ComboBox>
                                                <TextBlock Text="{DynamicResource 450_DopOffset}" Grid.Row="6" Grid.Column="0" Style="{StaticResource labelStyle}" TextWrapping="Wrap"/>
                                                <TextBox x:Name="tb450DopOffset" Grid.Row="6" Grid.Column="1" Margin="2,2,2,2" Width="60" Height="22" HorizontalAlignment="Left" VerticalAlignment="Top" LostKeyboardFocus="tb450DopOffset_LostKeyboardFocus"></TextBox>
                                                <Label Content="{DynamicResource 450_Speed}" Grid.Row="7" Grid.Column="0" Style="{StaticResource labelStyle}"></Label>
                                                <ComboBox x:Name="cb450Speed" Grid.Row="7" Grid.Column="1" Margin="2,2,2,2" SelectionChanged="cb450Speed_SelectionChanged" Width="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem Content="{DynamicResource 450_SpeedStandard}"></ComboBoxItem>
                                                    <ComboBoxItem Content="{DynamicResource 450_SpeedMagstripe}"></ComboBoxItem>
                                                    <ComboBoxItem Content="{DynamicResource 450_SpeedSmart}"></ComboBoxItem>
                                                </ComboBox>
                                            </Grid>
                                        </GroupBox>
                                    </Border>
                                    <Border BorderBrush="Gray" CornerRadius="0,10,10,10" BorderThickness="0" Name="borderPrinter" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Height="200" VerticalAlignment="Top">
                                        <GroupBox x:Name="xpsProperties">
                                        <Grid Margin="5,25,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="145"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="36"></RowDefinition>
                                                <RowDefinition Height="26"></RowDefinition>
                                                <RowDefinition Height="26"></RowDefinition>
                                                <RowDefinition Height="26"></RowDefinition>
                                                <RowDefinition Height="26"></RowDefinition>
                                                </Grid.RowDefinitions>
                                            <TextBlock Text="{DynamicResource XPSDrivers}" Grid.Row="0" Grid.Column="0" Style="{StaticResource labelStyle}" VerticalAlignment="Center" TextWrapping="Wrap"></TextBlock>
                                            <ComboBox x:Name="cbPrinterDrivers" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" SelectionChanged="cbPrinterDrivers_SelectionChanged"></ComboBox>
                                            <CheckBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" VerticalAlignment="Center" Content="{StaticResource OnlyPrint}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=OnlyPrint, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></CheckBox>
                                            <TextBlock Text="{DynamicResource CE870Hopper}" Grid.Row="2" Grid.Column="0" Style="{StaticResource labelStyle}" VerticalAlignment="Center" TextWrapping="Wrap"></TextBlock>
                                            <TextBox x:Name="tbCEHopper" Grid.Row="2" Grid.Column="1" Width="50" Style="{StaticResource textBoxStyle}" TextChanged="tbCEHopper_OnTextChanged"></TextBox>
                                            <CheckBox Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" VerticalAlignment="Center" Content="{StaticResource CETopper}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=NoTopper, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></CheckBox>
                                            <CheckBox Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" VerticalAlignment="Center" Content="{StaticResource CEGraphicTopper}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=GraphicTopper, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></CheckBox>
                                            </Grid>
                                        </GroupBox>
                                    </Border>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbEmbossLine" Visibility="Hidden" VerticalAlignment="Top">
                                <StackPanel Margin="5,5,5,5">
                                    <Label Style="{StaticResource labelStyle}" Content="{DynamicResource EmbossLine_FontLabel}"/>
                                    <ComboBox x:Name="cbEmbossLine_Font" Width="160" HorizontalAlignment="Left"  
										SelectionChanged="cbEmbossLine_Font_SelectionChanged" IsEditable="False" IsReadOnly="True">
                                        <ComboBoxItem Tag="1" Content="Gothic 10 c/i"/>
                                        <ComboBoxItem Tag="2" Content="Farrington 7B"/>
                                        <ComboBoxItem Tag="3" Content="OCR 10 c/i"/>
                                        <ComboBoxItem Tag="4" Content="MC Inverted 14 c/i"/>
                                        <ComboBoxItem Tag="5" Content="OCR 7 c/i"/>
                                    </ComboBox>
                                </StackPanel>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbEmbossText" Visibility="Hidden" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="36"/>
                                        <ColumnDefinition Width="104"/>
                                        <ColumnDefinition Width="28"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource DesignField_Shablon}"/>
                                    <TextBox Grid.Column="1" Grid.Row="0" Grid.ColumnSpan="3" x:Name="tbEmbossTextShablon" Height="22" Width="140" VerticalAlignment="Center" HorizontalAlignment="Left" TextChanged="tbEmbossTextShablon_TextChanged" />
                                    <Label Grid.Column="2" Grid.Row="1" Style="{StaticResource labelStyle}" Grid.ColumnSpan="4" x:Name="lEmbossTextLength"/>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{DynamicResource EmbossText_Position}"/>
                                    <TextBox Grid.Column="1" Grid.Row="1" x:Name="tbEmbossTextPosition" Height="22" VerticalAlignment="Center" TextChanged="tbEmbossTextPosition_TextChanged"/>
                                    <Label Grid.Column="0" Grid.Row="2" Style="{StaticResource labelStyle}" Content="{DynamicResource EmbossText_Align}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="4" x:Name="cbEmbossText_Align" Width="140" Height="22" HorizontalAlignment="Left"  IsEditable="False" IsReadOnly="True" SelectionChanged="cbEmbossText_Align_SelectionChanged">
                                        <ComboBoxItem Tag="1" Content="{DynamicResource Field_AlignLeft}"/>
                                        <ComboBoxItem Tag="3" Content="{DynamicResource Field_AlignRight}"/>
                                    </ComboBox>
                                    <Label Grid.Column="0" Grid.Row="3" Style="{StaticResource labelStyle}" Content="{DynamicResource Field_In}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="3" Grid.ColumnSpan="2" x:Name="cbEmbossText_In" Width="140" Height="20" HorizontalAlignment="Left" IsEditable="False" IsReadOnly="True" SelectionChanged="comboBoxDataIn_SelectionChanged"/>
                                    <Button x:Name="bEmbossTextIn" Grid.Row="3" Grid.Column="3" Width="24" Height="24" Click="bEmbossTextIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                        <!--<Image Source="pack://application:,,,/Images/Properties.png"/>-->
                                    </Button>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbEmbossText2" Visibility="Hidden" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="36"/>
                                        <ColumnDefinition Width="104"/>
                                        <ColumnDefinition Width="28"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource DesignField_Shablon}"/>
                                    <TextBox Grid.Column="1" Grid.Row="0" Grid.ColumnSpan="3" x:Name="tbEmbossText2Shablon" Height="22" Width="140" VerticalAlignment="Center" HorizontalAlignment="Left" TextChanged="tbEmbossText2Shablon_TextChanged">
                                        <TextBox.Text>
                                            <Binding Path="Shablon" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                                <Binding.ValidationRules>
                                                    <common:StringRule></common:StringRule>
                                                </Binding.ValidationRules>
                                            </Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Grid.ColumnSpan="4" x:Name="lEmbossText2Length" Content="{Binding ShablonLength}"/>                                    
                                    <Label Grid.Column="0" Grid.Row="2" Style="{StaticResource labelStyle}" Content="{DynamicResource EmbossLine_FontLabel}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" x:Name="cbEmbossLine2_Font" Width="140" HorizontalAlignment="Left"  IsEditable="False" IsReadOnly="True"
                                              ItemsSource="{Binding Source={StaticResource FontEnum}}" SelectedItem="{Binding Path=Font}"/>
                                    <Label Grid.Column="0" Grid.Row="3" Style="{StaticResource labelStyle}" Content="{DynamicResource EmbossText_Align}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="3" Grid.ColumnSpan="4" x:Name="cbEmbossText2_Align" Width="140" Height="22" HorizontalAlignment="Left"  IsEditable="False" IsReadOnly="True" SelectionChanged="cbEmbossText_Align_SelectionChanged">
                                        <ComboBoxItem Tag="1" Content="{DynamicResource Field_AlignLeft}"/>
                                        <ComboBoxItem Tag="3" Content="{DynamicResource Field_AlignRight}"/>
                                    </ComboBox>
                                    <Label Grid.Column="0" Grid.Row="4" Style="{StaticResource labelStyle}" Content="{DynamicResource Field_In}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="4" Grid.ColumnSpan="2" x:Name="cbEmbossText2_In" Width="140" Height="20" HorizontalAlignment="Left" IsEditable="False" IsReadOnly="True" SelectionChanged="comboBoxDataIn_SelectionChanged"/>
                                    <Button x:Name="bEmbossText2In" Grid.Row="4" Grid.Column="3" Width="24" Height="24" Click="bEmbossTextIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                        <!--<Image Source="pack://application:,,,/Images/Properties.png"/>-->
                                    </Button>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbMagStripe" Visibility="Hidden" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="140"></ColumnDefinition>
                                        <ColumnDefinition Width="28"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="26"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource MagStripe1}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="0" x:Name="cbMagStripe1" Width="140" Height="22" HorizontalAlignment="Left"
                                              SelectionChanged="comboBoxDataIn_SelectionChanged" Tag="1"></ComboBox>
                                    <Button x:Name="bMagstripe1In" Tag="1" Grid.Column="2" Grid.Row="0" Width="24" Height="24" Click="bMagstripeIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"  HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{DynamicResource MagStripe2}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="1" x:Name="cbMagStripe2" Width="140" Height="22" HorizontalAlignment="Left"
                                              SelectionChanged="comboBoxDataIn_SelectionChanged" Tag="2"></ComboBox>
                                    <Button x:Name="bMagstripe2In" Tag="2" Grid.Column="2" Grid.Row="1" Width="24" Height="24" Click="bMagstripeIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"  HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="2" Style="{StaticResource labelStyle}" Content="{DynamicResource MagStripe3}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="2" x:Name="cbMagStripe3" Width="140" Height="22" HorizontalAlignment="Left"
                                              SelectionChanged="comboBoxDataIn_SelectionChanged" Tag="3"></ComboBox>
                                    <CheckBox x:Name="cbReadMagstripe" Tag="3" Grid.Column="0" Grid.Row="3" Grid.RowSpan="2" Content="{DynamicResource MagStripeRead}" Checked="cbReadMagstripe_Checked" VerticalAlignment="Center" Style="{StaticResource labelStyle}"></CheckBox>
                                    <Button x:Name="bMagstripe3In" Grid.Column="2" Grid.Row="2" Width="24" Height="24" Click="bMagstripeIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"  HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                    </Button>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbText" Visibility="Hidden" VerticalAlignment="Top">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                        <ColumnDefinition Width="28"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="75"></RowDefinition>
                                        <RowDefinition Height="86"></RowDefinition>
                                        <RowDefinition Height="80"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{StaticResource DesignField_Shablon }"></Label>
                                    <TextBox Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="0" x:Name="tbTextFieldShablon" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" TextChanged="tbTextFieldShablon_TextChanged">
                                        <TextBox.Text>
                                            <Binding Path="Shablon" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                                <Binding.ValidationRules>
                                                    <common:StringRule></common:StringRule>
                                                </Binding.ValidationRules>
                                            </Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{StaticResource TextFont}"></Label>
                                    <TextBox Grid.Column="1" Grid.Row="1" x:Name="tbTextFont" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" IsReadOnly="true">
                                        <TextBox.Text>
                                            <Binding Path="FontString" Mode="OneWay"></Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Button x:Name="bTextFieldFont" Grid.Row="1" Grid.Column="2" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bTextFieldFont_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" ToolTip="{StaticResource TextFontChange}">
                                        <Path Data="M5,17v2h14v-2L5,17zM9.5,12.8h5l0.9,2.2h2.1L12.75,4h-1.5L6.5,15h2.1l0.9,-2.2zM12,5.98L13.87,11h-3.74L12,5.98z" Fill="Black"></Path>                                              
                                    </Button>
                                    <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"></RowDefinition>
                                            <RowDefinition></RowDefinition>
                                            <RowDefinition Height="25"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Column="0" Grid.Row="0" Content="{StaticResource TextFontColor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                        <Label Grid.Column="1" Grid.Row="0" Content="{StaticResource TextFontBackcolor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>                                        
                                        <toolk:ColorPicker Grid.Column="0" Grid.Row="1" BorderThickness="1" Margin="5,0,5,0" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=TextColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <toolk:ColorPicker Grid.Column="1" Grid.Row="1" BorderThickness="1" Margin="5,0,0,0" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=BackColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Grid.Row="2" Grid.Column="2" Margin="5,0,0,0" VerticalAlignment="Bottom" Content="{StaticResource TextFontTransparent}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=IsTransparent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></CheckBox>
                                    </Grid>
                                    <Grid Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"></RowDefinition>
                                            <RowDefinition Height="25"></RowDefinition>                                            
                                            <RowDefinition Height="25"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource TextAlign}"/>
                                        <ComboBox Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="0" x:Name="cbTextAlign" Height="20" HorizontalAlignment="Stretch" SelectionChanged="comboBox_SelectionChanged"
                                                  SelectedValuePath="ID" SelectedValue="{Binding HAlignmentBinding, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{DynamicResource TextRotate}"/>
                                        <ComboBox Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="1" x:Name="cbTextRotate" Height="20" HorizontalAlignment="Stretch" SelectionChanged="comboBox_SelectionChanged"
                                                  SelectedValuePath="ID" SelectedValue="{Binding TextRotateBinding, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <Label Grid.Column="0" Grid.Row="2" Style="{StaticResource labelStyle}" Content="{DynamicResource Field_In}"/>
                                        <ComboBox Grid.Column="1" Grid.Row="2" x:Name="cbTextField_In" Height="20" HorizontalAlignment="Stretch" IsEditable="False" IsReadOnly="True" SelectionChanged="comboBoxDataIn_SelectionChanged"/>
                                        <Button x:Name="bTextFieldIn" Grid.Row="2" Grid.Column="2" Width="24" Height="24" Click="bEmbossTextIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                            <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                        </Button>
                                    </Grid>
                                </Grid>                                
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbSmart" Visibility="Hidden" VerticalAlignment="Top" Height="400">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="26"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="26"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Content="{DynamicResource Field_In}" Style="{StaticResource labelStyle}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="0" x:Name="cbSmartIn" Width="160" Height="22" HorizontalAlignment="Left"
                                              SelectionChanged="comboBoxDataIn_SelectionChanged"></ComboBox>
                                    <Button x:Name="bSmartIn" Grid.Row="0" Grid.Column="1" Width="28" Height="28" Margin="165,0,0,0" HorizontalAlignment="Left" Click="bSmartIn_Click" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
                                        <Canvas Width="28" Height="28">
                                            <Path Data="M19.43,12.98c0.04,-0.32 0.07,-0.64 0.07,-0.98s-0.03,-0.66 -0.07,-0.98l2.11,-1.65c0.19,-0.15 0.24,-0.42 0.12,-0.64l-2,-3.46c-0.12,-0.22 -0.39,-0.3 -0.61,-0.22l-2.49,1c-0.52,-0.4 -1.08,-0.73 -1.69,-0.98l-0.38,-2.65C14.46,2.18 14.25,2 14,2h-4c-0.25,0 -0.46,0.18 -0.49,0.42l-0.38,2.65c-0.61,0.25 -1.17,0.59 -1.69,0.98l-2.49,-1c-0.23,-0.09 -0.49,0 -0.61,0.22l-2,3.46c-0.13,0.22 -0.07,0.49 0.12,0.64l2.11,1.65c-0.04,0.32 -0.07,0.65 -0.07,0.98s0.03,0.66 0.07,0.98l-2.11,1.65c-0.19,0.15 -0.24,0.42 -0.12,0.64l2,3.46c0.12,0.22 0.39,0.3 0.61,0.22l2.49,-1c0.52,0.4 1.08,0.73 1.69,0.98l0.38,2.65c0.03,0.24 0.24,0.42 0.49,0.42h4c0.25,0 0.46,-0.18 0.49,-0.42l0.38,-2.65c0.61,-0.25 1.17,-0.59 1.69,-0.98l2.49,1c0.23,0.09 0.49,0 0.61,-0.22l2,-3.46c0.12,-0.22 0.07,-0.49 -0.12,-0.64l-2.11,-1.65zM12,15.5c-1.93,0 -3.5,-1.57 -3.5,-3.5s1.57,-3.5 3.5,-3.5 3.5,1.57 3.5,3.5 -1.57,3.5 -3.5,3.5z" Fill="Black" />
                                        </Canvas>
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="1" Content="{DynamicResource Smart_Config}" Style="{StaticResource labelStyle}"/>
                                    <DockPanel Grid.Column="1" Grid.Row="1">
                                        <Label x:Name="lSmartTitle"  Content="{Binding SmartTitle}"/>
                                        <Button x:Name="bSmartConfig" DockPanel.Dock="Right" Height="28" Width="28" HorizontalAlignment="Right" VerticalAlignment="Top" Click="bSmartConfig_Click" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
                                            <Canvas Width="28" Height="28">
                                                <Path Data="M16,17.01V10h-2v7.01h-3L15,21l4,-3.99h-3zM9,3L5,6.99h3V14h2V6.99h3L9,3z" Fill="Black" />
                                            </Canvas>
                                        </Button>
                                        <self:DropDownButton x:Name="bSmartDefault" DockPanel.Dock="Right" Height="28" Width="28" HorizontalAlignment="Right" VerticalAlignment="Top" Click="bSmartConfig_Click" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" BorderThickness="0">
                                            <Canvas Width="28" Height="28">
                                                <Path Data="M19.43,12.98c0.04,-0.32 0.07,-0.64 0.07,-0.98s-0.03,-0.66 -0.07,-0.98l2.11,-1.65c0.19,-0.15 0.24,-0.42 0.12,-0.64l-2,-3.46c-0.12,-0.22 -0.39,-0.3 -0.61,-0.22l-2.49,1c-0.52,-0.4 -1.08,-0.73 -1.69,-0.98l-0.38,-2.65C14.46,2.18 14.25,2 14,2h-4c-0.25,0 -0.46,0.18 -0.49,0.42l-0.38,2.65c-0.61,0.25 -1.17,0.59 -1.69,0.98l-2.49,-1c-0.23,-0.09 -0.49,0 -0.61,0.22l-2,3.46c-0.13,0.22 -0.07,0.49 0.12,0.64l2.11,1.65c-0.04,0.32 -0.07,0.65 -0.07,0.98s0.03,0.66 0.07,0.98l-2.11,1.65c-0.19,0.15 -0.24,0.42 -0.12,0.64l2,3.46c0.12,0.22 0.39,0.3 0.61,0.22l2.49,-1c0.52,0.4 1.08,0.73 1.69,0.98l0.38,2.65c0.03,0.24 0.24,0.42 0.49,0.42h4c0.25,0 0.46,-0.18 0.49,-0.42l0.38,-2.65c0.61,-0.25 1.17,-0.59 1.69,-0.98l2.49,1c0.23,0.09 0.49,0 0.61,-0.22l2,-3.46c0.12,-0.22 0.07,-0.49 -0.12,-0.64l-2.11,-1.65zM12,15.5c-1.93,0 -3.5,-1.57 -3.5,-3.5s1.57,-3.5 3.5,-3.5 3.5,1.57 3.5,3.5 -1.57,3.5 -3.5,3.5z" Fill="Black" />
                                            </Canvas>
                                            <self:DropDownButton.Menu>
                                                <ContextMenu>
                                                    <MenuItem Header="{DynamicResource Smart_DefaultLoad}" Command="{x:Static self:CustomCommands.SmartDefaultLoad}"></MenuItem>
                                                    <MenuItem Header="{DynamicResource Smart_DefaultSave}" Command="{x:Static self:CustomCommands.SmartDefaultSave}"></MenuItem>
                                                </ContextMenu>
                                            </self:DropDownButton.Menu>
                                        </self:DropDownButton>
                                    </DockPanel>
                                    <Border BorderBrush="Gray" CornerRadius="0,0,10,10" BorderThickness="2" Name="borderSmart" Grid.Row="1" Grid.ColumnSpan="2" Height="400" VerticalAlignment="Top"
                                            Visibility="Visible">
                                        <GroupBox x:Name="gbSmartConfig" Margin="10,25,0,0" BorderThickness="0">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200"></ColumnDefinition>
                                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="26"></RowDefinition>
                                                    <RowDefinition Height="Auto"></RowDefinition>
                                                    <RowDefinition Height="*"></RowDefinition>
                                                </Grid.RowDefinitions>
                                                <Label Grid.Row="0" Grid.Column="0" Content="{DynamicResource Smart_Type}" Style="{StaticResource labelStyle}"></Label>
                                                <!-- <ComboBox x:Name="cbSmartType" Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="2,2,2,2" SelectionChanged="cbSmartType_SelectionChanged"
                                                           SelectedValue="{Binding SmartType}" SelectedValuePath="Tag" MinWidth="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem Tag="0" Content="{DynamicResource NotDefined}"></ComboBoxItem>
                                                    <ComboBoxItem Tag="8">Ostcard standard</ComboBoxItem>
                                                </ComboBox> -->
                                                <ComboBox x:Name="cbSmartType" Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="2,2,2,2" SelectionChanged="cbSmartType_SelectionChanged"
                                                    SelectedValue="{Binding SmartTypeIdString, Mode=TwoWay}" SelectedValuePath="Tag" MinWidth="150" HorizontalAlignment="Left">
                                                    <ComboBoxItem Tag="0" Content="{DynamicResource NotDefined}"></ComboBoxItem>
                                                    <ComboBoxItem Tag="8">Ostcard standard</ComboBoxItem>
                                                </ComboBox>
                                                <Label Grid.Row="1" Grid.Column="0" Content="{DynamicResource Smart_Timeout}" Style="{StaticResource labelStyle}"></Label>
                                                <TextBox x:Name="tbSmartTimeout" Grid.Row="1" Grid.Column="1" Width="40" Margin="2,2,2,2" HorizontalAlignment="Left" Text="{Binding Timeout}" TextChanged="tbSmartTimeout_TextChanged"></TextBox>
                                                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal">
                                                    <Label x:Name="lDllLabel" Content="{DynamicResource Smart_Dll}" Style="{StaticResource labelStyle}"></Label>
                                                    <Button x:Name="bSmartPath" Height="28" Width="28" VerticalAlignment="Center" HorizontalAlignment="Left" Click="bSmartPath_Click" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
                                                        <Canvas Width="28" Height="28">
                                                            <Path Data="M20,6h-8l-2,-2L4,4c-1.1,0 -1.99,0.9 -1.99,2L2,18c0,1.1 0.9,2 2,2h16c1.1,0 2,-0.9 2,-2L22,8c0,-1.1 -0.9,-2 -2,-2zM20,18L4,18L4,8h16v10z" Fill="Black" />
                                                        </Canvas>
                                                    </Button>
                                                    <TextBlock x:Name="tbDllPath" Margin="2,2,2,2" VerticalAlignment="Center" HorizontalAlignment="Left" TextWrapping="Wrap" Text="{Binding Path}"></TextBlock>
                                                </StackPanel>
                                                <GroupBox x:Name="gbSmartOstcardStandart" Visibility="Visible" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" BorderThickness="0">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="200"></ColumnDefinition>
                                                            <ColumnDefinition Width="*"></ColumnDefinition>
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="28"></RowDefinition>
                                                            <RowDefinition Height="Auto"></RowDefinition>
                                                            <RowDefinition Height="28"></RowDefinition>
                                                            <RowDefinition Height="28"></RowDefinition>
                                                            <RowDefinition Height="28"></RowDefinition>
                                                            <RowDefinition Height="28"></RowDefinition>
                                                            <RowDefinition Height="*"></RowDefinition>
                                                        </Grid.RowDefinitions>
                                                        <RadioButton Content="{DynamicResource Smart_OneWire}" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Style="{StaticResource labelStyle}" IsChecked="{Binding OneWire}"></RadioButton>
                                                        <StackPanel x:Name="spOneWire" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Vertical" IsEnabled="{Binding OneWire}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Label Style="{DynamicResource labelStyle}" Content="{DynamicResource Smart_OneWireType}" Width="80"></Label>
                                                                <ComboBox Margin="2" MinWidth="150" SelectedValue="{Binding OneWireType}" SelectedValuePath="Tag">
                                                                    <ComboBox.Items>
                                                                        <ComboBoxItem Content="{DynamicResource Smart_OneWireContact}" Tag="Contact"></ComboBoxItem>
                                                                        <ComboBoxItem Content="{DynamicResource Smart_OneWireContactless}" Tag="Contactless"></ComboBoxItem>
                                                                    </ComboBox.Items>
                                                                </ComboBox>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Label Style="{DynamicResource labelStyle}" Content="{DynamicResource Smart_OneWireProtocol}" Width="80"></Label>
                                                                <ComboBox Margin="2" MinWidth="150" SelectedValue="{Binding OneWireProtocol}" SelectedValuePath="Tag">
                                                                    <ComboBox.Items>
                                                                        <ComboBoxItem Content="{DynamicResource Smart_OneWireT0}" Tag="T0"></ComboBoxItem>
                                                                        <ComboBoxItem Content="{DynamicResource Smart_OneWireT1}" Tag="T1"></ComboBoxItem>
                                                                    </ComboBox.Items>
                                                                </ComboBox>
                                                            </StackPanel>
                                                        </StackPanel>
                                                        <RadioButton x:Name="rbPCSC" Content="{DynamicResource Smart_Reader}" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Style="{StaticResource labelStyle}" IsChecked="{Binding NotOneWire}"></RadioButton>
                                                        <StackPanel x:Name="spDoubleWire" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" IsEnabled="{Binding NotOneWire}">
                                                            <Label Width="80" Content="{DynamicResource Smart_Reader}" Style="{StaticResource labelStyle}"></Label>
                                                            <ComboBox x:Name="cbReaders" MinWidth="250" Style="{StaticResource textBoxStyle}" SelectedValue="{Binding Path=ReaderName, Mode=TwoWay}"></ComboBox>
                                                            <Button x:Name="bSmartReaderRefresh" Height="28" Width="28" VerticalAlignment="Center" HorizontalAlignment="Left" Click="bSmartReaderRefresh_Click"  Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
                                                                <Canvas Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Center">
                                                                    <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4c-4.42,0 -7.99,3.58 -7.99,8s3.57,8 7.99,8c3.73,0 6.84,-2.55 7.73,-6h-2.08c-0.82,2.33 -3.04,4 -5.65,4 -3.31,0 -6,-2.69 -6,-6s2.69,-6 6,-6c1.66,0 3.14,0.69 4.22,1.78L13,11h7V4l-2.35,2.35z" Fill="Black" />
                                                                </Canvas>
                                                            </Button>
                                                        </StackPanel>
                                                        <StackPanel Grid.Row="4" Grid.Column="0" Orientation="Horizontal">
                                                            <Label Width="80" Style="{StaticResource labelStyle}">IP HS.exe</Label>
                                                            <TextBox x:Name="tbHSIp" Width="100" Style="{StaticResource textBoxStyle}">
                                                                <TextBox.Text>
                                                                    <Binding Path="HSIP" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                                        <Binding.ValidationRules>
                                                                            <common:StringRule></common:StringRule>
                                                                        </Binding.ValidationRules>
                                                                    </Binding>
                                                                </TextBox.Text>
                                                            </TextBox>
                                                        </StackPanel>
                                                        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
                                                            <Label Content="{DynamicResource Smart_HSport}" Style="{StaticResource labelStyle}"></Label>
                                                            <TextBox x:Name="tbHSPort" Width="50" Style="{StaticResource textBoxStyle}">
                                                                <TextBox.Text>
                                                                    <Binding Path="HSPort" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                                                        <Binding.ValidationRules>
                                                                            <common:IntRule></common:IntRule>
                                                                        </Binding.ValidationRules>
                                                                    </Binding>
                                                                </TextBox.Text>
                                                            </TextBox>
                                                        </StackPanel>
                                                        <StackPanel Grid.Row="5" Grid.Column="0" Orientation="Horizontal">
                                                            <Label Width="80" Content="{DynamicResource Smart_Script}" Style="{StaticResource labelStyle}"></Label>
                                                            <TextBox x:Name="tbScript" Width="100" Style="{StaticResource textBoxStyle}" TextChanged="tbScript_TextChanged">
                                                                <TextBox.Text>
                                                                    <Binding Path="Script" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged"></Binding>
                                                                </TextBox.Text>
                                                            </TextBox>
                                                        </StackPanel>
                                                    </Grid>
                                                </GroupBox>
                                            </Grid>
                                        </GroupBox>
                                    </Border>
                                    <CheckBox x:Name="cbSmartFeedback" Grid.Row="2" Grid.ColumnSpan="2" Content="{DynamicResource Smart_Feedback}" Checked="cbSmartFeedback_Checked" IsEnabled="False"></CheckBox>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbImage" Visibility="Visible" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="28"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource Field_In}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="0" x:Name="cbImageIn" Height="20" HorizontalAlignment="Stretch" SelectionChanged="comboBoxDataIn_SelectionChanged"/>
                                    <Button x:Name="bImageIn" Grid.Row="0" Grid.Column="2" Width="24" Height="24" Click="bImageIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                        <!--<Image Source="pack://application:,,,/Images/Properties.png"/>-->
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{DynamicResource Image_Style}"></Label>
                                    <ComboBox Grid.Column="1" Grid.Row="1" x:Name="cbImageStyle" Height="20" HorizontalAlignment="Stretch" SelectionChanged="comboBox_SelectionChanged"
                                              SelectedValuePath="ID" SelectedValue="{Binding StyleBinding, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></ComboBox>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="0" x:Name="gbBarcode" Visibility="Hidden" VerticalAlignment="Top">
                                <Grid Margin="5,5,5,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="28"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="54"/>
                                        <RowDefinition Height="44"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition Height="24"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Column="0" Grid.Row="0" Style="{StaticResource labelStyle}" Content="{DynamicResource Field_In}"/>
                                    <ComboBox Grid.Column="1" Grid.Row="0" x:Name="cbBarcodeIn" Height="20" HorizontalAlignment="Stretch" SelectionChanged="comboBoxDataIn_SelectionChanged"/>
                                    <Button x:Name="bBarcodeIn" Grid.Row="0" Grid.Column="2" Width="24" Height="24" Click="bEmbossTextIn_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                        <Path Data="M11,9.16V2c-5,0.5 -9,4.79 -9,10s4,9.5 9,10v-7.16c-1,-0.41 -2,-1.52 -2,-2.84s1,-2.43 2,-2.84zM14.86,11H22c-0.48,-4.75 -4,-8.53 -9,-9v7.16c1,0.3 1.52,0.98 1.86,1.84zM13,14.84V22c5,-0.47 8.52,-4.25 9,-9h-7.14c-0.34,0.86 -0.86,1.54 -1.86,1.84z" Fill="Black" />
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource labelStyle}" Content="{StaticResource DesignField_Shablon }"></Label>
                                    <TextBox Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="1" x:Name="tbBarcodeShablon" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" TextChanged="textBoxChanged">
                                        <TextBox.Text>
                                            <Binding Path="Shablon" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                                <Binding.ValidationRules>
                                                    <common:StringRule></common:StringRule>
                                                </Binding.ValidationRules>
                                            </Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Label Grid.Column="0" Grid.Row="2" Style="{StaticResource labelStyle}" Content="{StaticResource Barcode_Type}"></Label>
                                    <ComboBox Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" x:Name="cbBarcodeType" Height="20" HorizontalAlignment="Stretch"
                                              ItemsSource="{Binding Source={StaticResource BarcodeEnum}}" SelectedItem="{Binding Path=Symbology}">
                                    </ComboBox>
                                    <Label Grid.Column="0" Grid.Row="3" Style="{StaticResource labelStyle}" Content="{StaticResource Barcode_TextFont}"></Label>
                                    <TextBox Grid.Column="1" Grid.Row="3" x:Name="tbBarcodeFont" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" IsReadOnly="true">
                                        <TextBox.Text>
                                            <Binding Path="FontString" Mode="OneWay"></Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Button x:Name="bBarcodeFont" Grid.Row="3" Grid.Column="2" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bBarcodeFont_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" ToolTip="{StaticResource TextFontChange}">
                                        <Path Data="M5,17v2h14v-2L5,17zM9.5,12.8h5l0.9,2.2h2.1L12.75,4h-1.5L6.5,15h2.1l0.9,-2.2zM12,5.98L13.87,11h-3.74L12,5.98z" Fill="Black"></Path>
                                    </Button>
                                    <Grid Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="3">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"></RowDefinition>
                                            <RowDefinition Height="25"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Column="0" Grid.Row="0" Content="{StaticResource Barcode_BarColor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                        <Label Grid.Column="1" Grid.Row="0" Content="{StaticResource Barcode_TextColor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                        <Label Grid.Column="2" Grid.Row="0" Content="{StaticResource Barcode_BackColor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                        <toolk:ColorPicker Grid.Column="0" Grid.Row="1" BorderThickness="1" Margin="5,0,5,0" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=BarColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <toolk:ColorPicker Grid.Column="1" Grid.Row="1" BorderThickness="1" Margin="5,0,5,0" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=TextColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <toolk:ColorPicker Grid.Column="2" Grid.Row="1" BorderThickness="1" Margin="5,0,6,0" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=BackColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </Grid>
                                    <GroupBox Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="3" Header="{StaticResource Barcode_BarDetails}" Style="{StaticResource labelStyle}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="1*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="25"></RowDefinition>
                                                <RowDefinition Height="25"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <StackPanel Grid.Column="0" Grid.Row="0" Orientation="Horizontal">
                                                <Label Content="{StaticResource Barcode_BarWidth}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                                <TextBox x:Name="tbBarWidth" Width="40" Style="{StaticResource textBoxStyle}" TextChanged="textBoxChanged">
                                                    <TextBox.Text>
                                                        <Binding Path="BarWidth" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                            <Binding.ValidationRules>
                                                                <common:DoubleRule></common:DoubleRule>
                                                            </Binding.ValidationRules>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Grid.Row="0" Orientation="Horizontal">
                                                <Label Content="{StaticResource Barcode_BarHeight}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                                <TextBox x:Name="tbBarHeight" Width="40" Style="{StaticResource textBoxStyle}" TextChanged="textBoxChanged">
                                                    <TextBox.Text>
                                                        <Binding Path="BarHeight" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                            <Binding.ValidationRules>
                                                                <common:DoubleRule></common:DoubleRule>
                                                            </Binding.ValidationRules>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" Grid.Row="0" Orientation="Horizontal">
                                                <Label Content="{StaticResource Barcode_BarRatio}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                                <TextBox x:Name="tbBarRatio" Width="40" Style="{StaticResource textBoxStyle}" TextChanged="textBoxChanged">
                                                    <TextBox.Text>
                                                        <Binding Path="BarRatio" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged" Converter="{StaticResource DoubleConverter}">
                                                            <Binding.ValidationRules>
                                                                <common:DoubleRule></common:DoubleRule>
                                                            </Binding.ValidationRules>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                            </StackPanel>
                                        </Grid>
                                    </GroupBox>
                                    <CheckBox Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="3" Margin="5,0,0,0" VerticalAlignment="Center" Content="{StaticResource Barcode_Control}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=AddControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Checked="CheckBox_Checked"></CheckBox>
                                    <CheckBox Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="3" Margin="5,0,0,0" VerticalAlignment="Center" Content="{StaticResource Barcode_StartStop}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=AddStartStop, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Checked="CheckBox_Checked"></CheckBox>
                                    <CheckBox Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="3" Margin="5,0,0,0" VerticalAlignment="Center" Content="{StaticResource Barcode_FitToField}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=FitToField, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Checked="CheckBox_Checked"></CheckBox>
                                    <CheckBox Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="3" Margin="5,0,0,0" VerticalAlignment="Center" Content="{StaticResource Barcode_ShowText}" Style="{StaticResource labelStyle}" FontSize="11" IsChecked="{Binding Path=ShowText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Checked="CheckBox_Checked"></CheckBox>
                                    <Label Grid.Column="0" Grid.Row="10" Style="{StaticResource labelStyle}" Content="{StaticResource Barcode_HeaderText }"></Label>
                                    <TextBox Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="10" x:Name="tbHeaderText" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" TextChanged="textBoxChanged">
                                        <TextBox.Text>
                                            <Binding Path="Header" NotifyOnValidationError="True" UpdateSourceTrigger="PropertyChanged">
                                                <Binding.ValidationRules>
                                                    <common:StringRule AllowEmpty="True"></common:StringRule>
                                                </Binding.ValidationRules>
                                            </Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Label Grid.Column="0" Grid.Row="11" Style="{StaticResource labelStyle}" Content="{StaticResource Barcode_HeaderFont}"></Label>
                                    <TextBox Grid.Column="1" Grid.Row="11" x:Name="tbBarcodeHeaderFont" Style="{StaticResource textBoxStyle}" HorizontalAlignment="Stretch" IsReadOnly="true">
                                        <TextBox.Text>
                                            <Binding Path="HeaderFontString" Mode="OneWay"></Binding>
                                        </TextBox.Text>
                                    </TextBox>
                                    <Button x:Name="bBarcodeHeaderFont" Grid.Row="11" Grid.Column="2" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bBarcodeHeaderFont_Click" BorderThickness="0" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" ToolTip="{StaticResource TextFontChange}">
                                        <Path Data="M5,17v2h14v-2L5,17zM9.5,12.8h5l0.9,2.2h2.1L12.75,4h-1.5L6.5,15h2.1l0.9,-2.2zM12,5.98L13.87,11h-3.74L12,5.98z" Fill="Black"></Path>
                                    </Button>
                                    <Label Grid.Column="0" Grid.Row="12" Content="{StaticResource Barcode_HeaderColor}" VerticalAlignment="Top" Style="{StaticResource labelStyle}"></Label>
                                    <toolk:ColorPicker Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="12" BorderThickness="1" Height="23" SelectedColorChanged="ColorToolbar_SelectedColorChanged" SelectedColor="{Binding Path=HeaderColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Grid>
        </Grid>
        <Grid x:Name="gPrint" Grid.Row="1" Visibility="Hidden">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="28"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel x:Name="spPrintToolbar" Grid.Row="0" Orientation="Horizontal" Background="#FFF0F0F0">
                    <ToolBarTray Background="#FFF0F0F0">
                        <ToolBar x:Name="tbPrint">
                            <Button x:Name="bSendToPrint" ToolTip="{DynamicResource ToolBar_SendToPrint}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.SendToPrint}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z" Fill="Black" />
                                </Canvas>
                            </Button>
                            <Separator/>
                            <Button x:Name="bFirstRecord" ToolTip="{DynamicResource ToolBar_FirstRecord}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.FirstRecord}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M18.41,16.59L13.82,12L18.41,7.41L17,6L11,12L17,18L18.41,16.59M6,6H8V18H6V6Z" Fill="Black" />
                                </Canvas>
                            </Button>
                            <Button x:Name="bPrevRecord" ToolTip="{DynamicResource ToolBar_PrevRecord}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.PrevRecord}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M18.41,16.59L13.82,12L18.41,7.41L17,6L11,12L17,18L18.41,16.59Z" Fill="Black" />
                                </Canvas>
                            </Button>
                            <Button x:Name="bNextRecord" ToolTip="{DynamicResource ToolBar_NextRecord}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.NextRecord}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M5.59,7.41L10.18,12L5.59,16.59L7,18L13,12L7,6L5.59,7.41Z" Fill="Black" />
                                </Canvas>
                            </Button>
                            <Button x:Name="bLastRecord" ToolTip="{DynamicResource ToolBar_LastRecord}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.LastRecord}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M5.59,7.41L10.18,12L5.59,16.59L7,18L13,12L7,6L5.59,7.41M16,6H18V18H16V6Z" Fill="Black" />
                                </Canvas>
                            </Button>
                            <Button x:Name="bLoadDb" ToolTip="{DynamicResource ToolBar_LoadDb}" ToolTipService.ShowOnDisabled="True" Command="{x:Static self:CustomCommands.LoadDbFile}">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M4,6L2,6v14c0,1.1 0.9,2 2,2h14v-2L4,20L4,6zM20,2L8,2c-1.1,0 -2,0.9 -2,2v12c0,1.1 0.9,2 2,2h12c1.1,0 2,-0.9 2,-2L22,4c0,-1.1 -0.9,-2 -2,-2zM20,12l-2.5,-1.5L15,12L15,4h5v8z" Fill="Black" />
                                </Canvas>
                            </Button>
                        </ToolBar>
                    </ToolBarTray>
                </StackPanel>
                <Grid x:Name="gPrints" Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.4*" MinWidth="100"/>
                        <ColumnDefinition Width="*" MinWidth="100"/>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1.6*" MinHeight="100"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*" MinHeight="10"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <self:DrawPanel x:Name="dpPrintFront" Background="White" ClipToBounds="True" MouseMove="dpPrintFront_MouseMove" 
								    SizeChanged="dpPrintFront_SizeChanged">
                                </self:DrawPanel>
                            </Grid>
                            <GridSplitter Grid.Row="1" HorizontalAlignment="Stretch" Cursor="SizeNS" Height="5"/>
                            <Grid Grid.Row="2">
                                <self:DrawPanel x:Name="dpPrintBack" Background="White" ClipToBounds="True" MouseMove="dpPrintBack_MouseMove"/>
                            </Grid>
                        </Grid>
                    </Grid>
                    <GridSplitter Grid.Column="0" VerticalAlignment="Stretch" Cursor="SizeWE" Width="5"/>
                    <StackPanel Grid.Column="1" Background="#FFF0F0F0" Orientation="Vertical">
                        <StackPanel>
                            <GroupBox Header="{DynamicResource PrintParameters}" FontWeight="Bold">
                                <StackPanel>
                                    <RadioButton x:Name="rbSingleCard" GroupName="Print" Margin="5,5,5,5" Content="{DynamicResource Print_CurrentCard}"></RadioButton>
                                    <RadioButton x:Name="rbToEnd" GroupName="Print" Margin="5,5,5,5" Content="{DynamicResource Print_ToEnd}"></RadioButton>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton x:Name="rbInRange" GroupName="Print" Margin="5,5,5,5" Content="{DynamicResource Print_Range}" VerticalAlignment="Center"></RadioButton>
                                        <TextBox x:Name="tbRangeStart" Width="40" Height="22" Margin="5,5,5,5"></TextBox>
                                        <Label Margin="5,5,5,5" Content="{DynamicResource Print_RangeTo}"></Label>
                                        <TextBox x:Name="tbRangeEnd" Width="40" Height="22" Margin="5,5,5,5"></TextBox>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Label x:Name="lPrintCopies" Margin="5,5,5,5" Content="{DynamicResource Print_Copies}" Width="{Binding ActualWidth, ElementName=rbInRange}"></Label>
                                        <TextBox x:Name="tbPrintCopies" Margin="5,5,5,5" Width="40" Height="22" IsEnabled="False"></TextBox>
                                    </StackPanel>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                        <StackPanel x:Name="spPrintValues" Orientation="Vertical"></StackPanel>
                    </StackPanel>
                </Grid>
            </Grid>
        </Grid>
        <StatusBar Grid.Row="2">
            <StatusBarItem x:Name="sbiPos" Width="100" BorderThickness="1"/>
            <StatusBarItem x:Name="sbiObjectName" Width="200" BorderThickness="1"/>
            <StatusBarItem x:Name="sbiDesign"/>
        </StatusBar>
    </Grid>
</Window>

    